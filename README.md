# tm
> time manage inspire by zoejane/tm.zoejane.net

## Background
> ä½¿ç”¨ aTimeLogger2 7å¹´äº†, æ‰å‘ç°è¿™æ˜¯ä¸ªå¤§å‘

- ä» `å¥‡ç‰¹çš„ä¸€ç”Ÿ` å…¥å‘çš„äººå¾ˆå¤š
- ä½†æ˜¯, çœŸæ­£æ ¹æ®è‡ªå·±çš„æƒ…å†µ, æ…¢æ…¢æ‰¾åˆ°å·¥å…·ç»„åˆ,å¹¶èƒ½å¯¹æ•°æ®è¿›è¡Œåˆç†åˆ†æçš„å¤ªå°‘
- æ›´åŠ å°‘çš„æ˜¯çœŸæ­£å¦‚ `æŸ³æ¯”æ­‡å¤«` é‚£æ ·å°†æ•°æ®åˆåä½œç”¨è‡ªå·±ç”Ÿæ´»ä¸­çš„...


## Goal
> æ‰€ä»¥, è¢«æ€¼å‹ä»¬è§¦å‘, ç­¹å¤‡å°†è¿™ä¸ªé¢†åŸŸçš„ç»éªŒå˜æˆä¸€é—¨è¯¾ç¨‹

- ä»¥è‡ªèº«ç§¯ç´¯æ•°æ®ä¸ºå¼•
- ä»¥è‡ªæ€¼åœˆç§¯ç´¯ä»£ç ä¸ºè¯
- ä¸ºç›®æ ‡å­¦å‘˜æœåŠ¡:
    + å½¢æˆé«˜æ•ˆå®¢è§‚æ—¶å¸è®°å½•ä¹ æƒ¯
    + å¯¹æ•°æ®è¿›è¡Œé’ˆå¯¹æ€§ç»Ÿè®¡åˆ†æ
    + å°±åˆ†æç»“æœå…±åŒè§£è¯»å¹¶å»ºè®®
    + ç›¸äº’ç£ä¿ƒæ ¹æ®ç»“æœæŒç»­æ”¹è¿›

## Process
> é‚£ä¹ˆ, è¿™ä¸ªç½‘ç«™åº”è¯¥æ˜¯é›†ä½“ç»´æŠ¤çš„, æ€ä¹ˆæ¥å‘¢?

å½“ç„¶ä¾æ‰˜ GitHub ç”Ÿæ€äº†:

- å…è´¹æ‰˜ç®¡, å¼€æºä»“åº“
- [utterances](https://utteranc.es/) å¯„ç”Ÿè¯„æ³¨
- å®šåˆ¶åŸŸå
- è¿œç¨‹è§¦å‘
- ç¼–è¯‘æ—¥å¿—å¤å®¡
- ...

### MkDocs
> å› ä¸ºæ˜¯ Pythonic ç¤¾åŒº,æ‰€ä»¥, é¦–å…ˆåœ¨ Python ç”Ÿæ€ä¸­é€‰æ‹©

- å…¶å®ƒå„ç§ é™æ€ç½‘ç»œå¼•æ“, éƒ½æ˜¯é’ˆå¯¹blog ç³»ç»Ÿçš„
- æœ€å¤§çš„é—®é¢˜å°±æ˜¯, å¼•æ“ä¾èµ– æ¯ç¯‡æ–‡ç«  .md çš„å¤´éƒ¨ é¢å¤– meta ä¿¡æ¯
    + è¿™å¯¹åŸºäº md çš„å†™ä½œå¾ˆæ˜¯ä¸ªå›°æƒ‘
- åªæœ‰ MkDocs æ˜¯é’ˆå¯¹å¼€å‘æ–‡æ¡£ç½‘ç«™è®¾è®¡çš„
    + æ¯ä¸ªå…·ä½“é¡µé¢å‘å¸ƒè·¯å¾„éƒ½æ˜¯è‡ªåŠ¨åŒ¹é…è‡ªç„¶ç›®å½•çš„
    + è€Œä¸”æ¯ä¸ª md éƒ½æ˜¯å¹²å‡€çš„, ä¸ç”¨å£°æ˜ä¸€å †å¤´éƒ¨ meta çš„
- æ‰€ä»¥, å°±æ˜¯å¥¹äº†...

### Deploy
> å¿…é¡»èƒ½è‡ªåŠ¨åŒ–è§¦å‘éƒ¨ç½²å‘¢...

æ‰€ä»¥,å½“å‰:


    local ++ _trigger/deploy.md
        +-> 101camp/tm
        |       .
        |       .
        |       |
        | [ztop@aliyun]
        |   +- crontab (15')
        |       +- tm
        |           +- inv pub tm
        |               +- _trigger/deploy.md
     branch                <if exsit>
    gh-pages                    +- mkdoc build
        |                         / |
        +--- <<- ----- tm_ghp <<-+  | (deploy logging)
          + <<- -  <<-+
          |    dlog_tm101camp
        branch 
      dlog_tm101camp
          |
          +-> 101camp/comments


åœ¨æœ‰å…³ä¸»æœºä¸­éƒ¨ç½²ä¸º:

- ç›®å½• tm å…‹éš†è‡ª [101camp/tm](https://github.com/101camp/tm) 
- ç›®å½• tm_ghp åˆ‡æ¢è‡ª[101camp/tm at gh\-pages](https://github.com/101camp/tm/tree/gh-pages) 
    + å¹¶å°† tm_ghp ç”¨ `ln -s` è½¯é“¾æ¥å½¢å¼, é“¾æ¥åˆ° `tm/site`
    + ä½œä¸º MkDocs ç¼–è¯‘ç›®æ ‡ç›®å½•
- ç›®å½• dlog_tm101camp ä½¿ç”¨ orphan åˆ†æ”¯å…‹éš†æ³•, å•ç‹¬ clone [101camp/comments at dlog\_tm101camp](https://github.com/101camp/comments/tree/dlog_tm101camp) 
    + ä½œä¸ºç¼–è¯‘äº‹åŠ¡æ—¥å¿—å®¹å™¨
- [cron4trig2tm\.sh](https://github.com/101camp/tm/blob/master/cron4trig2tm.sh) ä½œä¸ºä¸»æœºå®šæœŸä»»åŠ¡
    + æ¯ 15 åˆ†é’Ÿè‡ªåŠ¨è¿è¡Œä¸€è¡Œ
    + è°ƒç”¨ `inv pub tm` æŒ‡ä»¤
    + è¿™æ˜¯ç”± [tasks\.py](https://github.com/101camp/tm/blob/master/tasks.py) æä¾›çš„
    + å°†è‡ªåŠ¨åŒ–å®Œæˆä¸€ç³»åˆ—è¡Œä¸º, ä¸»è¦åŒ…å«:
        * åŒæ­¥æ‰€æœ‰ä»“åº“
        * æ£€éªŒæ˜¯å¦æœ‰ `_trigger/deploy.md` è§¦å‘æ–‡ä»¶
        * å¦‚æœæœ‰,åˆ™ä½¿ç”¨ `mkdoc build` æŒ‡ä»¤ç¼–è¯‘æœ€æ–°ç‰ˆæœ¬ç½‘ç«™
        * ç„¶å, è¿›å…¥ `tm_ghp` ç›®å½•å°†ç”Ÿæˆçš„é™æ€ç½‘ç«™ push ç»™ github å®Œæˆæœ€åçš„å‘å¸ƒ
- åŒæ—¶, [cron4trig2tm\.sh](https://github.com/101camp/tm/blob/master/cron4trig2tm.sh) æ”¶é›†è‡ªåŠ¨å‘å¸ƒè¿‡ç¨‹ä¸­çš„æ‰€æœ‰ç³»ç»Ÿè¾“å‡º
    + å†™å…¥ `dlog_tm101camp` å¯¹åº”ç›®å½•çš„ .log æ–‡ä»¶
    + å¹¶ push ç»™ github
    + è¿™æ ·, å³ä¾¿æˆ‘ä»¬ä¸åœ¨ç”µè„‘å‰, æ— æ³•è¿œç¨‹ç™»é™†ä¸»æœº
    + ä¹Ÿå¯ä»¥è§‚å¯Ÿåˆ°å¯¹åº”å‘å¸ƒè¡Œä¸ºè¿‡ç¨‹æ˜¯å¦æœ‰é—®é¢˜
    
    
#### ä¸ºä»€ä¹ˆä¸ä½¿ç”¨ `mkdocs gh-deploy` è¿›è¡Œéƒ¨ç½²ï¼Ÿ

è®¨è®ºæ¥è‡ªäº 200212 @Slack

@zoejane 
> æˆ‘æƒ³è¯·æ•™çš„æ˜¯ï¼Œå¦‚æœæ—¥å¸¸æ˜¯ç”¨è‡ªå·±çš„ç”µè„‘ï¼Œmkdocs gh-deploy æ“ä½œç®€æ´ï¼Œè¿è¡Œåæ— éœ€ç­‰å¾…ï¼Œå®æ—¶ç”Ÿæ•ˆï¼Œä¸æ˜¯æ›´æ–¹ä¾¿å—ï¼Ÿæˆ‘æ—¥å¸¸ä½¿ç”¨ mkdocs gh-deployæ¨é€ç½‘é¡µï¼Œä¼š å¯¹æ•´ä¸ªè‡ªåŠ¨åŒ–éƒ¨ç½²ã€æˆ–è€…ç½‘ç«™è¿è¡Œæœ‰ä»€ä¹ˆä¸å¥½çš„å½±å“å—ï¼Ÿ

@ZoomQuiet 
> ä½ çœ‹ä¸€ä¸‹ invoke è„šæœ¬å°±çŸ¥é“äº†â€¦.  
> æ—¥å¸¸ä½¿ç”¨, é™¤éæ²¡æœ‰å…¶å®ƒé¢å¤–è¿½åŠ æ“ä½œ,  
> æ˜¯å…¼å®¹çš„, å¦‚æœæœ‰ç‰¹æ®Šè¡Œä¸ºå°±ä¸è¡Œäº†â€¦.  
> æ¯”å¦‚, ä½ å¯èƒ½æ²¡å‘ç°, gh-deploy ä»…ä»…è¿›è¡Œäº† build æ“ä½œ,  
> ä½†æ˜¯, inv pub ä¸­åŒ…å«äº†å¤§é‡çš„è‡ªåŠ¨åŒ– æ–‡ä»¶æ„ŸçŸ¥å’Œç´¢å¼•ç”Ÿæˆæ“ä½œ,  
> è¿™æ˜¯ mkdoc ä¸åŒ…å«çš„è¡Œä¸º  

@zoejane 
> æ˜ç™½äº†ï¼Œæ¯”å¦‚æœ‰çš„auto index injected by xxxçš„å†…å®¹ï¼Œæ˜¯éœ€è¦å¯¹åº”è„šæœ¬å»å®ç°çš„ï¼Œ
> å¦‚æœå¾ˆå¤šå†…å®¹å¯ä»¥è‡ªåŠ¨æŠ“å–ï¼Œåç»­å°±ä¸ç”¨æ‰‹å·¥æ›´æ–°äº†

@ZoomQuiet 
> å› ä¸º mkdoc build åªå¹²äº†ä¸¤ä»¶äº‹å„¿:  
> 0: å°½å¯èƒ½å°†æ‰€æœ‰ doc ä¸­çš„ md ç¼–è¯‘ä¸º html  
> 1: æ ¹æ® .yaml é…ç½®æ–‡ä»¶å°†æŒ‡å®šçš„å…³é”®é¡µé¢ç»„æˆç½‘ç«™  
> ä½†æ˜¯, æˆ‘ä»¬çš„ç½‘ç«™å·²ç»è¿›ä¸€æ­¥å®šåˆ¶åŒ–äº†:  
> é…ç½®åªè§„åˆ’äº†æ ç›®ç»“æ„,ä½†æ˜¯, æ‰€æœ‰æ›´æ–°å¸¦æ¥çš„å˜åŒ–è¦æ±‚è‡ªåŠ¨åŒ–å®Œæˆå¢è¡¥:  
> 0: é¦–é¡µçš„æœ€è¿‘ 7ç¯‡æ–‡ç« ç´¢å¼•  
> 1: æ¯ä¸ªæ ç›®é¦–é¡µçš„æ‰€æœ‰æ–‡ç« ç´¢å¼•  
> 2: â€¦  
> æ‰€ä»¥, ä½ æ‡‚çš„â€¦  

### Usage
> è€Œæ‰€æœ‰è”åˆè¿è¥æˆå‘˜, æƒ³æ›´æ–° tm.101.camp ç½‘ç«™å†…å®¹å°±éå¸¸ç®€æ´äº†

- å…‹éš† [101camp/tm](https://github.com/101camp/tm) 
- å¯¹ `docs/` ä¸­çš„ .md æ–‡ä»¶è¿›è¡Œè‡ªç„¶çš„ç¼–å†™/åˆ›å»º/åˆ é™¤/...
- ç„¶å, `touch _trigger/deploy.md`, åˆ›å»ºä¸€ä¸ªç©ºç™½æ–‡ä»¶(deploy.md)åˆ°çº¦å®šç›®å½•ä¸­
- æäº¤å˜æ›´
- ä¸€èˆ¬ç­‰å¾…10åˆ†é’Ÿå·¦å³, å°±å°†å®Œæˆè‡ªåŠ¨éƒ¨ç½².


## Debug:
> ç„¶è€Œ, æƒ³çœŸæ­£æ•´ä¸ªæµç¨‹å¯ä»¥åœ¨æœ¬åœ°è·‘èµ·æ¥, è¿˜æ˜¯æœ‰ç‚¹å„¿é…ç½®çš„...

### env. 
> éƒ¨ç½²å’Œä¸»æœºç«¯ä¸€è‡´çš„ç›®å½•æ ‘

ä»ä¸€ä¸ªåˆé€‚çš„çœŸæ­£çš„ç©ºç™½ç›®å½•å¼€å§‹:

    path/2/å…¨æ–°ç©ºç™½ç›®å½•:
        +- tm_ghp/ ~ å‘å¸ƒåˆ†æ”¯, é…åˆ github-pages ç³»ç»Ÿ
        |       clone è‡ª github.com:101camp/tm    
        |           å¹¶åˆ‡æ¢åˆ° gh-pages åˆ†æ”¯
        |       
        +- tm/ ~ ä¸»åˆ†æ”¯, æ’°å†™
        |       clone è‡ª github.com:101camp/tm    
        |               ç„¶å, ln -s ../tm_ghp/ site
        |       
        `- dlog_tm101camp/
                ç”¨ orphan åˆ†æ”¯ç‹¬ç«‹ clone çš„æ–¹æ³•å¤åˆ¶ commits ä»“åº“çš„ä¸“ç”¨åˆ†æ”¯
                $ mkdir dlog_tm101camp
                $ cd dlog_tm101camp/
                $ git init .
                $ git remote add -t dlog_tm101camp \
                        f origin  git@github.com:101camp/comments.git
                $ git co dlog_tm101camp
                $ git br -a
                * dlog_tm101camp
                  remotes/origin/dlog_tm101camp


ç„¶å, å°†è¿™ä¸ªåŒ…å«ä¸‰ä¸ªåŠŸèƒ½ä»“åº“çš„ç›®å½•, è¿½åŠ åˆ°ç³»ç»Ÿç¯å¢ƒä¸­

$ echo 'export CAMP_TM="path/2/å…¨æ–°ç©ºç™½ç›®å½•"' >> ~/.bash_profile

æ›´æ–°ç³»ç»Ÿå˜é‡:

$ source ~/.bash_profile

åº”è¯¥å¯ä»¥æ£€éªŒåˆ°è®¾ç½®æˆåŠŸ:

    $ env | grep CAMP_TM
    CAMP_TM="path/2/å…¨æ–°ç©ºç™½ç›®å½•

> è¿”å›çš„ç›®å½•å°±æ˜¯ä¸‰ä¸ªåŠŸèƒ½ä»“åº“çš„æ ¹ç›®å½•

### inv
å…ˆæ‰¹é‡å®Œæˆä¾èµ–æ¨¡å—çš„å®‰è£…:

    $ pip install -r requirements.txt

ç„¶å, è¿›å…¥ tm ç›®å½•å°±å¯ä»¥ä½¿ç”¨ä¸“ç”¨è„šæœ¬æ¥å®Œæˆè‡ªåŠ¨åŒ–æ‰¹é‡å‘å¸ƒå¤„ç½®äº†:

> æ£€éªŒæ‰€æœ‰æŒ‡ä»¤:

    $  inv -l
    Available tasks:

      bu       usgae MkDocs build AIM site
      ccname
      pub      $ inv pub blog <- auto deploy new site version base multi-repo.
      ver      echo crt. verions

> è‡ªåŠ¨å‘å¸ƒ:

    $  git pub tm
    [master ebc694c] ğŸ› PUBLISH: tm
     2 files changed, 81 insertions(+), 2 deletions(-)
     create mode 100644 requirements.txt


## refer.

- [å¥‡ç‰¹çš„ä¸€ç”Ÿ (æŸ³æ¯”æ­‡å¤«åšæŒ56å¹´çš„â€œæ—¶é—´ç»Ÿè®¡æ³•â€)](https://book.douban.com/subject/1115353/)
- [aTL2 ç§äººæ•…äº‹ ~ DebugUself with DAMA ;-)](https://du.101.camp/2018-10/atl2tt-story/)
- ...




## logging

- 200303 ZQ å¢è¡¥ inv pub tm ä½¿ç”¨è¯´æ˜
- 202012 ZQ å¢è¡¥è¯´æ˜
- 202010 ZQ init.

